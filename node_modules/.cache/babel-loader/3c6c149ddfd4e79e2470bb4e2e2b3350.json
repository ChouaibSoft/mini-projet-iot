{"remainingRequest":"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/babel-loader/lib/index.js!/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/src/components/SignIn.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/src/components/SignIn.vue","mtime":1577122887805},{"path":"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/home/clokbani/linux/DevWeb/mini-projet-iot/iot-platform/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Form from \"@/components/Form\";\nimport { required } from 'vuelidate/lib/validators';\nimport { mapActions, mapGetters } from 'vuex';\nexport default {\n  name: \"SignIn\",\n  components: {\n    'generic-form': Form\n  },\n  data: function data() {\n    return {\n      component: 'sign-in',\n      selected: 1,\n      email: '',\n      password: '',\n      forgetPassword: false,\n      look: false\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['getApiUrl'])),\n  methods: _objectSpread({}, mapActions(['switchProgress', 'postRequest']), {\n    login: function login() {\n      var _this = this;\n\n      var postData = {\n        email: this.email,\n        password: this.password\n      };\n      var payload = {\n        'data': postData,\n        'link': '/authentification-service/login'\n      };\n      this.switchProgress();\n      this.look = true;\n      this.postRequest(payload).then(function (request) {\n        return _this.loginSuccessful(request);\n      }).catch(function () {\n        _this.switchProgress();\n\n        _this.look = false;\n\n        _this.flash(_this.$t('auth.login-failed'), 'error');\n      });\n    },\n    loginSuccessful: function loginSuccessful(req) {\n      var _this2 = this;\n\n      if (req.headers) {\n        this.$store.dispatch('saveUserToken', req.headers.authorization);\n        this.$http.get(this.getApiUrl + '/authentification-service/id', {\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Bearer ' + this.$store.state.token\n          }\n        }).then(function (request) {\n          _this2.$store.dispatch('saveUserId', request.data);\n\n          _this2.switchProgress();\n\n          _this2.look = false;\n\n          _this2.$router.push('/dashboard');\n        });\n        return false;\n      }\n    }\n  }),\n  validations: {\n    email: {\n      required: required\n    },\n    password: {\n      required: required\n    }\n  }\n};",{"version":3,"sources":["SignIn.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA,OAAA,IAAA,MAAA,mBAAA;AACA,SAAA,QAAA,QAAA,0BAAA;AACA,SAAA,UAAA,EAAA,UAAA,QAAA,MAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,QADA;AAEA,EAAA,UAAA,EAAA;AACA,oBAAA;AADA,GAFA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,SAAA,EAAA,SADA;AAEA,MAAA,QAAA,EAAA,CAFA;AAGA,MAAA,KAAA,EAAA,EAHA;AAIA,MAAA,QAAA,EAAA,EAJA;AAKA,MAAA,cAAA,EAAA,KALA;AAMA,MAAA,IAAA,EAAA;AANA,KAAA;AAQA,GAdA;AAeA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,WAAA,CAAA,CADA,CAfA;AAkBA,EAAA,OAAA,oBACA,UAAA,CAAA,CACA,gBADA,EAEA,aAFA,CAAA,CADA;AAKA,IAAA,KALA,mBAKA;AAAA;;AACA,UAAA,QAAA,GAAA;AACA,QAAA,KAAA,EAAA,KAAA,KADA;AAEA,QAAA,QAAA,EAAA,KAAA;AAFA,OAAA;AAIA,UAAA,OAAA,GAAA;AACA,gBAAA,QADA;AAEA,gBAAA;AAFA,OAAA;AAIA,WAAA,cAAA;AACA,WAAA,IAAA,GAAA,IAAA;AACA,WAAA,WAAA,CAAA,OAAA,EAAA,IAAA,CAAA,UAAA,OAAA;AAAA,eAAA,KAAA,CAAA,eAAA,CAAA,OAAA,CAAA;AAAA,OAAA,EACA,KADA,CACA,YAAA;AACA,QAAA,KAAA,CAAA,cAAA;;AACA,QAAA,KAAA,CAAA,IAAA,GAAA,KAAA;;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,KAAA,CAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,OAAA;AACA,OALA;AAMA,KAtBA;AAuBA,IAAA,eAvBA,2BAuBA,GAvBA,EAuBA;AAAA;;AACA,UAAA,GAAA,CAAA,OAAA,EAAA;AACA,aAAA,MAAA,CAAA,QAAA,CAAA,eAAA,EAAA,GAAA,CAAA,OAAA,CAAA,aAAA;AACA,aAAA,KAAA,CAAA,GAAA,CAAA,KAAA,SAAA,GAAA,8BAAA,EAAA;AACA,UAAA,OAAA,EAAA;AACA,4BAAA,kBADA;AAEA,6BAAA,YAAA,KAAA,MAAA,CAAA,KAAA,CAAA;AAFA;AADA,SAAA,EAMA,IANA,CAMA,UAAA,OAAA,EAAA;AACA,UAAA,MAAA,CAAA,MAAA,CAAA,QAAA,CAAA,YAAA,EAAA,OAAA,CAAA,IAAA;;AACA,UAAA,MAAA,CAAA,cAAA;;AACA,UAAA,MAAA,CAAA,IAAA,GAAA,KAAA;;AACA,UAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA,YAAA;AAEA,SAZA;AAaA,eAAA,KAAA;AACA;AACA;AAzCA,IAlBA;AA6DA,EAAA,WAAA,EAAA;AACA,IAAA,KAAA,EAAA;AACA,MAAA,QAAA,EAAA;AADA,KADA;AAIA,IAAA,QAAA,EAAA;AACA,MAAA,QAAA,EAAA;AADA;AAJA;AA7DA,CAAA","sourcesContent":["<template>\n    <div id=\"sign-in\" class=\"col s12\">\n        <form v-if=\"!forgetPassword\" class=\"col s12 form\"  @submit.prevent=\"login\">\n            <div class=\"form-container\">\n                <h4>{{ $t('auth.welcome') }}</h4>\n                <generic-form>\n                    <div slot=\"form-fields\">\n                        <div class=\"row\">\n                            <div class=\"input-field col s12\">\n                                <i class=\"material-icons prefix\">account_circle</i>\n                                <input\n                                        id=\"email\"\n                                        type=\"text\"\n                                        class=\"validate\"\n                                        required\n                                        v-model=\"email\"\n                                        @input=\"$v.email.$touch()\">\n                                <label for=\"email\">{{ $t('auth.email') }}</label>\n                                <div v-if=\"$v.email.$dirty\">\n                                    <p class=\"error-message red-text \" v-if=\"!$v.email.required\">\n                                        {{ $t('errors.required') }}\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"row\">\n                            <div class=\"input-field col s12\">\n                                <i class=\"material-icons prefix\">lock</i>\n                                <input\n                                        id=\"password\"\n                                        type=\"password\"\n                                        class=\"validate\"\n                                        required\n                                        v-model=\"password\"\n                                        @input=\"$v.password.$touch()\">\n                                <label for=\"password\">{{ $t('auth.password') }}</label>\n                                <div v-if=\"$v.password.$dirty\">\n                                    <p class=\"error-message red-text \" v-if=\"!$v.password.required\">\n                                        {{ $t('errors.required') }}\n                                    </p>\n                                </div>\n                                <a href=\"#\" class=\"forget-password\" @click=\"forgetPassword = !forgetPassword\">{{ $t('auth.forgot-password') }}</a>\n                            </div>\n                        </div>\n                    </div>\n                    <div slot=\"form-controls\">\n                        <center>\n                            <button :disabled=\"look === true\" class=\"btn waves-effect waves-light  submit\" type=\"submit\" name=\"action\">{{ $t('auth.sign-in') }}</button>\n                        </center>\n                    </div>\n                </generic-form>\n            </div>\n        </form>\n        <form v-else class=\"col s12\"  @submit.prevent=\"forgetPassword\">\n            <div class=\"form-container form\">\n                <h5>{{ $t('auth.forgot-password') }}</h5>\n                <generic-form>\n                    <div slot=\"form-fields\">\n                        <div class=\"row\">\n                            <div class=\"input-field col s12\">\n                                <i class=\"material-icons prefix\">email</i>\n                                <input\n                                        id=\"email-2\"\n                                        type=\"text\"\n                                        class=\"validate\"\n                                        required\n                                        v-model=\"email\"\n                                        @input=\"$v.email.$touch()\">\n                                <label for=\"email-2\">{{ $t('auth.email') }}</label>\n                                <div v-if=\"$v.email.$dirty\">\n                                    <p class=\"error-message red-text \" v-if=\"!$v.email.required\">\n                                        {{ $t('errors.required') }}\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>o\n                    <div slot=\"form-controls\">\n                        <center>\n                            <a @click=\"forgetPassword= !forgetPassword\" class=\"btn waves-effect waves-light\" name=\"action\">{{ $t('auth.cancel') }}</a>\n                            <a :disabled=\"look === true\" style=\"margin-left: 50px\" class=\"btn waves-effect waves-light  submit\" type=\"submit\" name=\"action\">{{ $t('auth.submit') }}</a>\n                        </center>\n                    </div>\n                </generic-form>\n            </div>\n        </form>\n    </div>\n</template>\n\n<script>\n    import Form from \"@/components/Form\";\n    import { required } from 'vuelidate/lib/validators'\n    import {  mapActions, mapGetters } from 'vuex';\n\n    export default {\n        name: \"SignIn\",\n        components: {\n            'generic-form': Form\n        },\n        data() {\n            return {\n                component: 'sign-in',\n                selected: 1,\n                email: '',\n                password: '',\n                forgetPassword: false,\n                look : false\n            }\n        },\n        computed: {\n            ...mapGetters(['getApiUrl'])\n        },\n        methods: {\n            ...mapActions([\n                'switchProgress',\n                'postRequest'\n            ]),\n            login() {\n                var postData = {\n                    email: this.email,\n                    password: this.password\n                };\n                var payload = {\n                    'data': postData,\n                    'link': '/authentification-service/login'\n                };\n                this.switchProgress();\n                this.look = true;\n                this.postRequest(payload).then(request => this.loginSuccessful(request))\n                    .catch( ()=> {\n                        this.switchProgress();\n                        this.look = false;\n                        this.flash(this.$t('auth.login-failed'), 'error')\n                    })\n            },\n            loginSuccessful(req) {\n                if (req.headers) {\n                    this.$store.dispatch('saveUserToken', req.headers.authorization);\n                    this.$http.get( this.getApiUrl +  '/authentification-service/id',{\n                            headers:{\n                                'Content-Type': 'application/json',\n                                'Authorization': 'Bearer '+ this.$store.state.token\n                            }\n                        }\n                    ).then(request=>{\n                        this.$store.dispatch('saveUserId', request.data)\n                        this.switchProgress();\n                        this.look = false;\n                        this.$router.push('/dashboard');\n\n                    })\n                    return false;\n                }\n            },\n        },\n        validations: {\n            email: {\n                required,\n            },\n            password: {\n                required,\n            }\n        },\n    }\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/components"}]}